- # 一般步骤
	- ![[截屏2022-07-29 18.35.37.png]]
	- 不同的研究的步骤可能有出入
	- 建议参考顶尖期刊的步骤
- # Step1 导入数据
	- “File → Import data → Use EEGLAB functions and plugins”（ 选择相应的数据文件格式，如“From ANT EEProbe .cnt file”）。
	- 然后，弹出如下界面。
		- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic3.zhimg.com%2Fv2-52402b04f38ceda4cebf68bf97d45bce_b.jpg)
	    - 【注释】Neuroscan和ANT厂家的“.cnt”文件不同，不能混着使用。
			- 1.格式转化
				- Neuroscan的数据格式是cdt，无法直接转化，需要下载扩展包：File--manage EEGLAB extensions---会出来勾选，选中loadcurry2.0----把这个扩展包下载后放到eeglab文件下的plugins文件里，之后转格式就可以了。
				- File--Import data---Using EEGLAB fountions and plugins---From neuroscan curry files--选中文件夹里的cdt格式数据打开---会生成datdset1---file---save current dataset as---重新命名保存到另一个文件夹1\_set. 每个被试的每个run循环步骤。
			- 2.合并数据
				- File---clear study\\clear all(清除dataset，保证打开的数据顺序从1开始)--- Loading existing dataset ---同时选中1\_set文件夹里被试1的几个run**（注意：经检验，只能两个两个合并出来的数据到去伪迹那一步才可以打开，原因未知，所以在这里run1、2合并，run3、4合并，然后再进行合
					- 解决方法：在合并数据前把CB1,CB2去掉，就可以多个数据合并。
					- 原因：CB1、CB2是neuroscan系统里额外设置的两个电极点。）---生成dataset1和2---Edit---Append datasets ---dataset indices to merge 填1:2（看生成的数据，同时打开了3个数据，会生成数据123，就填1:3）---OK---Save it as file（选择文件夹2\_merge中,保存为sub1）。 每个被试循环此步骤，<mark style="background: #BBFABBA6;">也可用脚本</mark> 
		    - ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-93c303c1dd97c0e5f7fd3a8a3906f1c9_b.jpg)
		- 【注释】一般选择默认(默认是指导入完整数据)，但如果确定只分析完整数据中的某一段，可以设置数据段的起始时间，单位为秒。
		*  数据导入完毕后，EEGLAB主界面显示导入EEG数据的参数信息。
			* ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic3.zhimg.com%2Fv2-92e499cb362776b7ed19b4286c05667a_b.jpg)
				* Channels per frame 是通道
				* Frames per epoch
				* Eochs
				* Events
				* Sampling rates(Hz)
				* Epoch start (sec)
				* Epoch end(sec)
				* Reference
				* Channel locations
				* ICA weights
				* Dataset size(Mb)
- # Step2 定位电极
	*  “Edit → Channel locations → Look up locations → OK”。
		- 【注释】一般选择“Look up locs”弹出一个界面，默认电极标准为“10-5-385cap”系统。如若选择其它个性化电极坐标文件，可以现在“Read locations”中加载需要用到的定位电极系统。
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-4dfac376fb6a9810298941d13dd7d0c3_b.jpg)
			- 【注释】默认已经选好的标准系统，查看所有电极的参数信息。
				- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-13643726022e03e09d55579c189aa00c_b.jpg)
		*   浏览头皮地形图，查看相应电极坐标位置。
			* ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic3.zhimg.com%2Fv2-b447b154e0487d4315caf9b1c2d07a96_b.jpg)
	- 【Every Step】浏览数据
		*  “Plot → Channel data(scroll)”。
			* ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-27dcf1fbadb0f72e1a074a1b34737727_b.jpg)
		- 【注释】建议新手每处理一步查看一下数据，以便对比观察每一步数据处理的效果，有利于掌握每一步数据处理具体作用。同时数据处理步骤或参数设置的问题也可通过查看数据快速发现。
- # Step3 剔除无用电极
	*   “Edit → Select data → Channel range”。
		* 【注释】选取需要去除的电极，并一定要勾选右边的方框。
			* ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic3.zhimg.com%2Fv2-6d54466fe0ed9e8354510600e3d748d6_b.jpg)
		* File---loading exsting dataset ---选择2\_merge文件夹中的sub1打开生成数据1----Edit---Select data----出来对话框第四行右边小方框点对勾，小方框后边点开选中要去除的电极（在此处选中水平和垂直眼电及EKG和EMG，，有的实验也把CB1,CB2,O1,O2去除）----OK----Save it as file前面方框选中，点Browse，选择要保存在3-delete文件夹中----文件名sub1**（保存文件名时最好不要保存成sub01，不然到后面的步骤会有问题）**\-----保存。每个被试循环此步骤。
- # Step4 重参考(Re-reference)
	*   “Tools → Re-reference data”。
		* 【注释】重参考的方法有双侧乳突，全脑平均，鼻尖参考等，本文这里选取全脑平均做参考，勾选第一个方框。
			* ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-43efb49aae6a4aea77b7229aee0aeabb_b.jpg)
		- File---loading exsting dataset ---选择5-filter文件夹中的sub1打开生成数据1---Tools---Re-reference---出来界面如下：
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-ac9011789197ecac488c555cc91d1e9d_b.jpg)
			- 设置完之后点OK---保存数据到6-re-reference文件夹中，保存为sub1。
			- 注意：
				- 全脑平均做重参考还是选择M1M2做重参考，需要看自己的实验需求和本身的数据好坏情况，或者自己去看文献来确定.
- # Step5 滤波
	*   “Tools → Filter the data → Basic FIR filter (new,default)”。
		- 【注释】该界面中使用的是低通（35Hz）、高通滤波（0.1Hz）的带通滤波器。
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-d0dd6794cd1ef88fecf69f766c9fd087_b.jpg)
		- 【注释】一般低通滤波器设置在50Hz以下时会同时滤掉50Hz市电干扰信号，但通过数据查看市电干扰依然严重时选择使用Nortch 滤波。选取频带范围：49~51Hz，滤去50Hz市电干扰。
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-fc5e486c297fa9569498fc0ff192a51b_b.jpg)
		- File---loading exsting dataset ---选择4-quweiji文件夹中的sub1打开生成数据1---Tools----Filter the data----Basic FIR filter(new,default)----出来的界面如下：
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-375e99422ffdbf701fdeb5565c37a21c_b.jpg)
			- 注意：
				- 0.1滤波需要很长时间大约十几分钟，需尽量让其他软件结束运行，打开任务管理器监督一下，0.1滤波完成之后，保存数据到5-filter文件夹中，sub1，再在sub1的基础上滤波30hz，滤波完之后，保存替换sub1。。。30滤波很快，几秒钟，滤波时出来的图可以在滤波结束之后直接关掉。
- # Step6 分段与基线校正
	*  分段（epoch）
		* “Tools → Extract epochs”。
			* 【注释】选好标记的Mark 类型（如，1、10、2、4、7），分段的时间段（刺激前200ms到刺激后800ms）。
				* ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-10a3be96686de3b25c76b2fb07865620_b.jpg)
		- File---loading exsting dataset ---选文件夹中6-re-ference的sub1打开生成数据1---Tools---Extract epochs---出来界面如下：
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-d3e9b39a2d369e7292f79c6e5fd672e0_b.jpg)
			- 点OK,保存sub1数据到文件夹7-epoch1中
		- 注意：
			- 2：只选mark，boundary是每个run衔接的部分，不选择。
			- 5：这个是选择的时间段，mark点前0.1s，即100ms，作为基线，mark后0.7s，即700ms，这个时间段一定要包含我们想要分析的成分，比如N170,P200,N400，-0.1和0.7要根据实验需求来定，根据文献来定。
	- 基线校正：
		- 根据上步的分段，自动弹出基线校正时间刺激前200ms到0ms。
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-ee41787dc49e7464c7e75658de387188_b.jpg)
		- 给时间分段完成之后会自动跳出来确认基线水平的对话框：
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-9722186aed1298b9d272d72822533515_b.jpg)
			- 确认和上一步的-0.1基线水平一样，直接点ok,再保存一下，保存到8-baseline1文件夹中。
		- 注意：
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-c57b391e0e2cca753b6ba3b24868a683_b.jpg)
				- 这个对话框中的overwrite选项，只是不改变原有数据的情况下进行替换，但是并没有进行保存，所以baseline这一步如果同时Save it as 和Overwrite的话，只是保存了分段数据，没有保存基线水平确认的数据（只是在数据集里进行了改写，并没有保存到你的文件夹里），所以后面的步骤你可能就会看到基线那里出问题，就是最后波形图出来的时候，基线-100到0那一段，不在横轴上下浮动，所以影响很大！！！！，所以，多这一步，重新保存到另外一个文件夹里吧。
					- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-a6efb00ca768fd820ca3b405d3bf2e8c_b.jpg)
- # Step7 插值坏导或剔除坏段
	*  “Tools→Interpolate electrodes”。
		* ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-0341f9925d10fb4500c0a13520fad7c5_b.jpg)
	- 【注释】
		- 若是在“Step3” 中删除了电极，在此步骤需要选择第一栏，采用插值法补上原先删除的电极。若是没有删除电极，可以在这步骤中选择第二栏，对需要插值的电极进行计算。
		- 也可用语句代码实现，如：“EEG.data(7,:,:)=mean(EEG.data(\[11 32 40 38\]),:,:)”，即如果要对电极通道7进行插补，可以用电极点7 周围的四个电极点平均值代替。
	- # Step8 Run ICA
	*  “Tools→Decomposed data by ICA”。
		* ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-cb524cfc08703b28238bddc5abe7055f_b.jpg)
		* 【注释】在 ‘extended’,1后输入 ‘pca’,63（所有需要做眼电校正的电极数目）。此外由于ICA运行较慢并且易卡顿电脑，为防意外建议在ICA运行前保存一次数据，避免ICA运行崩溃时前边处理步骤需要重新做一遍。
			* ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-72a3c5d50000ca920c6979fd4e3f8175_b.jpg)
	- 数据处理中......等待一段时间。
	*  保存数据（ICA运行完后注意再次保存数据，不然ICA可能前功尽弃）。
- # Step9 剔除眼动成分
	*  “Tools → Inspect/label components by Map”。
		- 【注释】
			- 这一步骤手动去删除眼电需要基于数据分析者的经验判断进行。
			- 当有足够的把握确定是眼电伪迹，在该步骤中可以手动剔除；如果模棱两可，可以请经验丰富的人帮忙判断，或是保留。本示例中，选择剔除IC1和IC4成分。
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-a7b9a57e67fadeb89f3cd95e57f5af74_b.jpg)
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-5c45cd40ae7b109ba2cf9ea6d3692e2b_b.jpg)
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic3.zhimg.com%2Fv2-7fe096b70f0a1510efe2df47650c0776_b.jpg)
- # 10 保存数据
	- 以上就是单个被试EEG数据的预处理操作步骤和界面呈现，是用GUI方式完成的操作。
	- 当然，我们收集的数据一般不会只有一个，在MATLAB中可以用编写语句的方式实现批量处理多个被试EEG数据（通过EEGLAB的EEG.history查看数据处理步骤调用的MATLAB代码，然后根据被试量添加“for end”循环语句进行批处理。
	- 其中肉眼检查ICA成分，并删除ICA成分需要手动操作，不能进行批处理）。
----
# 事件相关电位（ERP）实验数据分析--全手动操作步骤（neuroscan）

[zhuanlan.zhihu.com](https://zhuanlan.zhihu.com/p/363256338)爱奋斗的小燕子心有猛虎，细嗅蔷薇。关注她

系统基于国际10～20系统扩展的64导电极帽，以NeuroScan系统记录EEG信号。利用MATLAB中的EEGLAB插件对数据进行预处理

**写在前边：**该手动处理步骤，均有脚本(代码)可以进行批量处理，以上方法适合小白刚开始处理erp数据的时候，可以更加细致的了解每一步的步骤和意图， 不至于只机械的跑代码。

\-----------------------------------------------------------------------------------------------**预处理的基本步骤如下（该步骤基于自己的实验数据决定）：**

1、格式转化cdt--set

2、合并数据，将一个被试的几个run合并成一个数据（sub1的run1、run2、run3、run4合并成sub1）（合并其实就是拼接）

3、去不需要的电极

4、去伪迹（scroing）,去掉眨眼波

5、滤波（高通0.1hz，低通30hz，分开滤波）

6、重新设参考（全脑平均average或M1M2平均）

7、给时间分段（epoch1）

8、Baseline1

9、ICA独立成分分析（有可以跑2次）

10、ADJUST 去掉不好的成分，即红色部分

11、按条件分段（epoch2）

12、Baseline2

13、按条件合并

14、画图（按条件画）

\-----------------------------------------------------------------------------------------------

**这是文章中数据分析方法的呈现：**

**数据分析：**利用MATLAB中的EEGLAB插件对数据进行预处理。30名被试的数据都纳入分析。在离线分析时，重新参考电极为双侧乳突的平均。对EEG信号进行分析时，滤波带通为0.1～30Hz，删除眼动、肌电并排除电位超过±75μV的伪迹。把刺激出现前100ms至刺激出现后700ms作为本实验分析的范围。以刺激前100ms作为基线水平进行校正。

\~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**以下是数据分析详细的处理步骤：**


**1、格式转化**


**2、合并数据**



**3、去电极**



**4、去伪迹**

File---loading exsting dataset ---选择3-delete文件夹中的sub1打开生成数据1----Plot-----第二个Channel data(scroll)-----点出来后出来一个对话框如下：

![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-9404b1043e41f119d5389af75f6ed843_b.jpg)

去伪迹结束后点reject----保存文件到4-quweiji。剩下被试重复此步骤。





**7、时间分段（epoch1）**



**8、Baseline1**



**9.ICA独立成分分析**

File---loading exsting dataset ---选文件夹中8-baseline2的sub1打开生成数据1---Tools---Run ICA---等它自己跑完，出现Done,然后另存为，File--Save current dataset as ---保存到9-ICA文件夹中。

**10 .ADJUST**

File---loading exsting dataset ---选文件夹中9-ICA的sub1打开生成数据1---Tools---ADJUST1.1.1---点OK，每个成分都会出来，一般把红色的记下来，关掉窗口，Tools--Remove components--第一行把计下来的红色成分，以空格隔开输入进去，点OK，另存为10-ADJUST文件夹中。

**11\. 按条件分段（epoch2）**

同步骤7。在选择条件的时候，分开一个一个选择，例如，在步骤7的第4步只选择一个条件11，剩余条件依次选择。

**12\. Baseline2**

同步骤8

**13\. 合并条件**

同步骤2

**14\. 画图**

打开-File---loading exsting dataset ---选文件夹中的全部实验条件（ 11 12 21 22），同时选中，生成data1234，下一步，Plot-Sum/Compare ERPs-出现如下图所示：

![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-b0041d160ab74bcfd570739f9a553cd4_b.jpg)

填好之后点ok，如下图所示，出来62个电极点的波形图，4个data数据依次，出来4个这样的图，之后根据自己的需要，选择同样的电极点，依次把4个图中的波形图通过复制粘贴到同一个图中，再进行图形的编辑，包括颜色，粗细等等，具体编辑点击view-property Editor，编辑好之后，点file-save/save as 就出来pdf的图了，之后为了美观，使用软件Adobe illustrator CS5进行美化波形图。

![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-72ad205bef17cd20a933faea98402535_b.jpg)

**再次强调**：以上手动处理步骤，均有脚本(代码)可以进行批量处理，以上方法适合小白刚开始处理erp数据的时候，可以更加细致的了解每一步的步骤和意图， 不至于只机械的跑代码。

问：跑完一步怎么看跑这一步的代码（脚本）？

答：手动进行一步后保存，点File--history scripts-save dataset history

**写在后边：**

以上内容仅仅是自己的一些数据处理步骤，适合小白，如有任何问题，记得给我留言或者私信，我会及时回复。如果此分享对您有用，别忘了点赞和收藏喔！

[查看原网页: zhuanlan.zhihu.com](https://zhuanlan.zhihu.com/p/363256338)