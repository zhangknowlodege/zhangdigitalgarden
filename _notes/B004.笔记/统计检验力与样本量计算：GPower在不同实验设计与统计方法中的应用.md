# 统计检验力与样本量计算：GPower在不同实验设计与统计方法中的应用



一、前言

心理学与管理学研究中，常常使用假设检验的方法进行实验设计和数据处理，假设检验的过程涉及到四个关键的参数：α（显著性水平）、1-β（即power，统计检验力）、effect size（效应量）和sample size（样本量）。社会科学领域的学者们在做实证研究前常常通过确定显著性水平、统计检验力、（预估）效应量来计算出需要的样本量大小。这一过程被称为先验的统计检验力分析（priori power analysis）。先验的统计检验力分析是大多数研究者最常遇到的问题，掌握之后也可在计算其它参数时达到举一反三的效果。

本文主要介绍如何用GPower做先验的统计检验力分析，除了GPower以外，文章最后一部分也推荐和简单介绍了一些可以做统计检验力分析的其他软件和网站。

二、统计检验力分析

具体讲解统计检验力分析之前，本节将介绍一些分析中通用参数的设置，包括显著性水平，统计检验力, 效应量, 单侧双侧检验等。

-   显著性水平 α
    

通常报告的α为.05, .01和.001。

本文在做统计检验力分析时均以0.05的显著性水平（α = .05）计算。

-   统计检验力Statistical power（1-β）
    

在被试量和经费有限的情况下，一般将统计检验力设置为0.8即足够；在有条件的情况下，可将统计检验力设为0.95甚至0.99。

本文中均以80%的统计检验力（power = 0.8）计算。

-   效应量Effect size
    

统计检验力分析是针对某一具体的效应（effect）进行的，因此在同一实验设计（如，A×B被试间设计）中，在效应量和显著性水平固定时，检测A的主效应、B的主效应和A×B的交互效应所需要的样本量都可能不同，需要分别计算。

一般来说，在确定样本量时，以需要样本量最多的一个效应（交互效应）为准。因为，当N个样本足以在统计检验力为0.8，显著性水平在0.05及以下时检测中等大小的A×B交互效应时，N个样本便可以得到更大的统计检验力来检测A或B的主效应。

但是，如果根据研究假设，不需要检测A×B交互效应，则可以只计算检测A或B的主效应所需要的样本量（无须计算检测交互效应的样本量），以节约经费和样本量。

具体计算中，效应量的确定主要通过三个方法：

1）参考文献中报告的效应量；

2）通过GPower中的Determine选项，通过输入其它已知参数（如，平均数、标准差、相关系数等）来计算效应量；

3）直接确定检测“大”、“中”或“小”效应量（文末附效应量解读表）。

本文均以中等大小的效应量（medium effect size）为例。

-   双侧单侧检验
    

双侧检验（two-tailed test）：检验抽样的样本统计量与假设参数的差异是否过大（无论正或负方向）。如果显著性水平为5%，那么概率曲线正负两边各分摊2.5%。例：检测某高中男女身高是否有显著差异。

单侧检验（one-tailed test）：检验抽样的样本统计与假设参数相比是否偏高或偏低，只检测某一方向。如果显著性水平为5%，那么概率曲线的正或负一侧占5%。例：检测某高中男生身高是否显著高于女生。

本文均采用双侧检验。

三、GPower统计检验力分析的具体操作

（选取常用的统计方法介绍）

在GPower中，统计检验力分析主要分为五步：确定实验设计和变量类型 → 选择统计方法（t-test、ANOVA、regression等）→ 选择分析类型（priori、post hoc等）→ 输入参数（α、1-β等）→ 输出结果（sample size、power等）。

小贴士：GPower中易混淆参数

Numerator df：各因素（变量）水平数-1再相乘。

Number of groups：被试间变量的水平数相乘。

Number of measures：被试内变量的水平数相乘。

【目录检索】

1. 自变量：分类变量；因变量：连续变量

1.1. 被试间设计

1.1.1. 单因素两水平（被试间）

【t test - Means: Difference between two independent means (two groups)】

1.1.2. 单因素多水平（被试间）

【F tests - ANOVA: Fixed effects, omnibus, one-way】

1.1.3. 两因素或多因素（被试间）

【F test - ANOVA: Fixed effects, special, main effects and interactions】

1.1.4. 两因素或多因素（被试间），协变量为连续变量

【F test - ANCOVA: Fixed effects, main effects and interactions】

1.2. 被试内设计

1.2.1. 单因素两水平（被试内）

【t test - Means: Difference between two dependent means (matched pairs)】

1.2.2. 单因素多水平（被试内）

【F tests - ANOVA: Repeated measures, within factors】

1.3. 被试间与被试内混合设计

1.3.1. 两因素混合设计

【F tests - ANOVA: Repeated measures, between/within/between-within factors】

2. 多个因变量

【F test - MANOVA】

3. 两个以上连续变量相关分析

【Exact - Correlation: Bivariate normal model】

4. 反应变量为连续变量（线性回归分析）

【F tests - Linear multiple regression: Fixed model, R² deviation from zero/R2 increase】

5. 反应变量为分类变量（逻辑回归分析）

【z tests - Logistic regression】

1

自变量：分类变量；因变量：连续变量

1.1. 被试间设计

1.1.1. 单因素两水平（被试间）

例：考察不同教学方法（应试教学vs.素质教学）对学业成绩的影响。学生被随机分配到应试教学或素质教学方法中。

自变量：教学方法（分类变量，被试间变量，两个水平）；

因变量：成绩（连续变量）。

选择独立样本t检验 【t test - Means: Difference between two independent means (two groups)】

输入：

![图片](https://image.cubox.pro/article/2022050120042553254/20449.jpg)

图一：独立样本t检验  

注：图一中，Allocation ratio N2/N1为两组数据样本量的比例，此处假定两组样本量相等，则比例为1；效应量位中等大小的值，实际应用中也可点击Determine根据均值和方差计算。

输出：128人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出教学方法中等大小的主效应（d = 0.5）。

1.1.2. 单因素多水平（被试间）

例：考察不同年级（初一vs.初二vs.初三）身高的差异。

自变量：年级（分类变量，被试间变量，三水平）；

因变量：身高（连续变量）。

选择单因素方差分析【F tests - ANOVA: Fixed effects, omnibus, one-way】

输入：

![图片](https://image.cubox.pro/article/2022050120042524032/61720.jpg)

图二：单因素方差分析  

注：图二中，Number of groups为该被试间因素的水平数3。

输出：159人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出年级中等大小的主效应（f = 0.25）。

1.1.3. 两因素或多因素（被试间）

例：在2（性别：男vs.女）× 3（年级：初一vs.初二vs.初三）× 2（教学方法：应试教学vs.素质教学）的被试间设计中，考察两种教学方法对不同性别和年级的学生学业成绩的影响。

注：普通的方差分析中，变量类型须为被试间变量。

自变量：性别（分类变量，被试间变量，两个水平），年级（分类变量，被试间变量，三个水平），教学方法（分类变量，被试间变量，两个水平）；

因变量：成绩（连续变量）。

选择多因素方差分析【F test - ANOVA: Fixed effects, special, main effects and interactions】

-   性别×年级×教学方法三重交互
    

输入：

![图片](https://image.cubox.pro/article/2022050120042579680/44287.jpg)

图三：多因素方差分析三重交互效应

注：图三中，Numerator df计算方法为在性别（2）×年级（3）×教学方法（2）三重交互中的每个因素的水平数减1再相乘，即 (2-1)×(3-1)×(2-1) = 2；Number of groups为被试间变量的水平数相乘，即2×3×2 = 12。

158人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出性别×年级×教学方法中等大小的三重交互效应（f = 0.25）。

-   性别×教学方法二重交互
    

根据具体的研究问题，一个2×3×2的实验设计可能只需要检测多个二重交互效应，而不需检测三重交互效应，此时需针对具体的效应做统计检验力分析。

输入：

![图片](https://image.cubox.pro/article/2022050120042559959/94034.jpg)

图四：多因素方差分析二重交互效应

注：上图中，Numerator df计算方法为在性别（2）×教学方法（2）二重交互中的每个因素的水平数减1再相乘，即 (2-1)×(2-1) = 1；Number of groups为被试间变量的水平数相乘，即2×2 = 4。

输出：128人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出性别×教学方法中等大小的二重交互效应（f = 0.25）。

其它二重交互效应计算方法同理。

1.1.4 两因素或多因素（被试间），协变量为连续变量

例：考察两种教学方法（应试教学vs.素质教学）对不同性别（男vs.女）的学生学业成绩的影响，同时控制智力水平的影响。

自变量：性别（分类变量，组间变量，两水平），教学方法（分类变量，组间变量，两水平）；

协变量：智力（连续变量）；

因变量：成绩（连续变量）。

选择协变量方差分析【F test - ANCOVA: Fixed effects, main effects and interactions】

输入：

图五：协变量方差分析  

注：图五中，Numerator df = (2-1)×(2-1) = 1 （性别2，教学方法2），Number of groups = 2×2 = 4（性别2，教学方法2），Number of covariates = 1（智力）

输出：128人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出性别×教学方法中等大小的交互效应（f = 0.25）。

1.2. 被试内设计

1.2.1. 单因素两水平（被试内）

例：考察学生对不同学科（语文vs.数学）喜爱程度的差异。

自变量：学科（分类变量，被试内变量，两水平）；

因变量：喜爱程度（连续变量）。

选用配对样本t检验【t test - Means: Difference between two dependent means (matched pairs)】

输入：

图六：配对样本t检验  

输出：34人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出学科中等大小的主效应（dz = 0.5）。

1.2.2. 单因素多水平（被试内）

例：测量某种教学方法在T1、T2、T3三个时间点对学生学业成绩的影响。

自变量：时间点（分类变量，被试内变量，三水平）；

因变量：成绩（连续变量）。

选用重复测量方差分析-被试内【F tests - ANOVA: Repeated measures, within factors】

输入：

图七：重复测量方差分析（被试内）  

注：图七中，由于没有被试间变量，所以Numerator of groups = 1；Number of measures为被试内变量的水平数（如有多个则相乘），所以为3；Corr among repeated measures为估计各重复测量间的相关，此例中三个时间点上学生成绩的相关应为较高水平，因此输入默认值0.5（具体操作时可参考文献）；Nonsphericity correction ε = 1为默认值。

输出：28人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出时间点中等大小的主效应（f = 0.25）。

1.2.3. 两或多因素（被试内）

GPower暂不支持该实验设计的统计检验力计算。

1.3. 被试间与被试内混合设计

1.3.1. 两因素混合设计

例：测量两种教学方法（应试教学vs.素质教学）在T1、T2、T3三个时间点对学生学业成绩的影响。

自变量：教学方法（分类变量，被试间变量，两水平），时间点（分类变量，被试内变量，三水平）；

因变量：成绩（连续变量）。

同一个实验设计中，根据需要检测的效应不同，在GPower中选择的统计方法和设置的参数也有相应的变化。

-   检测被试间因素主效应
    

即，检测教学方法对成绩的主效应。

选择重复测量方差分析-被试间【F tests - ANOVA: Repeated measures, between factors】

输入：

![图片](https://image.cubox.pro/article/2022050120042614710/27718.jpg)

图八：混合设计重复测量方差分析（被试间）

注：图八中，Number of groups = 2，因为教学方法的水平数为2；Number of measures = 3，因为每个被试在3个时间点上重复接受了测量；Corr among rep measures = 0.5（原因同1.2.2.）。

86人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出教学方法中等大小的主效应（f = 0.25）。

-   检测被试内因素主效应
    

即，检测时间点对成绩的主效应。

选择重复测量方差分析-被试内【F tests - ANOVA: Repeated measures, within factors】

输入：

![图片](https://image.cubox.pro/article/2022050120042695892/56040.jpg)

图九：混合设计重复测量方差分析（被试内）

注：对比1.2.2.，虽然都选了重复测量方差分析-被试内，但是在完全被试内设计（图七）中没有被试间变量，Number of groups = 1，而在此混合设计中被试间变量的水平数为2，Number of groups = 2；两种设计被试内变量水平数都为3，因此Number of measures = 3；Corr among rep measures = 0.5（原因同1.2.2.）；Nonsphericity correction ε = 1为默认值。

输出：28人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出时间点中等大小的主效应（f = 0.25）。

与1.2.2.相比，由于四舍五入，样本量都为28人，统计检验力的具体小数值有细微差别。

-   检测被试间与被试内因素的交互效应
    

即，检测教学方法×时间点对成绩的交互效应。

选择重复测量方差分析-被试间被试内【F tests - ANOVA: Repeated measures, within-between factors】

输入：

图十：混合设计重复测量方差分析（被试间被试内混合）  

注：图十中，Number of groups = 2，因为教学方法的水平数为2；Number of measures = 3，因为每个被试在3个时间点上重复接受了测量；Corr among rep measures = 0.5（原因同1.2.2.）；Nonsphericity correction ε = 1为默认值。

输出：28人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出教学方法×时间点中等大小的交互效应（f = 0.25）。

1.3.2. 多因素混合设计

GPower暂不支持该实验设计的统计检验力计算。

2

自变量：分类变量；因变量：（两个及以上）连续变量

例：考察教学方法（应试教学vs.素质教学）对不同性别（男vs.女）的学生学业成绩和对学习的喜欢程度的影响。

自变量：教学方法（分类变量，被试间变量，两水平），性别（分类变量，被试间变量，两水平）；

因变量：成绩（连续变量），喜欢程度（连续变量）。

选用多变量方差分析【F test - MANOVA】

MANOVA并不十分常用，具体参数设置可参考前面介绍过的例子，这里不再详细介绍，如有疑问欢迎联系作者讨论。

参考提示：

-   MANOVA: Global effects可参考ANOVA: Fixed effects, omnibus, one-way
    
-   MANOVA: Specific effects and interactions可参考ANOVA: Fixed effects, main effects, and interactions
    
-   MANOVA: Repeated measures, between factors/within factors/between-within factors可分别参考ANOVA: Repeated measures, between factors/within factors/between-within factors
    

3

不区分自变量与因变量，变量均为连续变量

例：考察学生对学习的喜爱程度与学业成绩之间的相关关系。

变量：对学习的喜爱程度（连续变量），成绩（连续变量）

选择相关分析【Exact - Correlation: Bivariate normal model】

输入：

图十一：相关分析  

注：图十一中，中点开Determine可以看到效应量ρ就是相关系数r的绝对值。

输出：84人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出中等大小的相关效应（ρ = 0.3）。

4

自变量：有连续变量（也可有分类变量）；因变量：连续变量

例：考察学生对学习的喜爱程度和智力水平对学业成绩的预测作用，控制学习时长。

预测变量：对学习的喜爱程度（连续变量），智力（连续变量）；

控制变量：学习时长（连续变量）

反应变量：成绩（连续变量）。

-   检测预测系数R2的绝对变化（与0相比）
    

选择多重线性回归R2【F tests - Linear multiple regression: Fixed model, R² deviation from zero】

输入：

![图片](https://image.cubox.pro/article/2022050120042672347/19823.jpg)

图十二：线性回归分析R2（绝对增量）  

输出：68人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出智力和喜爱程度中等大小的预测效应（f2 = 0.15）。

-   检测预测系数R2的相对变化（在前一个或前一组预测变量基础上的增量）
    

选择多重线性回归R2增量【F tests - Linear multiple regression: Fixed model, R² increase】

输入：

![图片](https://image.cubox.pro/article/2022050120042564621/41345.jpg)

图十三：线性回归分析R2（相对增量）  

注：图十三中，Number of tested predictors为预测变量个数，Total number of predictors为预测变量+控制变量个数。

输出：68人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出智力和喜爱程度中等大小的预测效应（f2 = 0.15）。

5

预测变量：（一个）连续或分类变量；反应变量：（一个）分类变量

5.1. 预测变量为连续变量的逻辑回归  

例：考察学生对学习的喜爱程度对文理分科偏好的预测作用，控制智力和学习时长。

主要预测变量：对学习的喜爱程度（连续变量）；

协变量：智力（连续变量），学习时长（连续变量）；

反应变量：文理分科偏好（分类变量；两水平：理科=1，文科=0）。

选择逻辑回归【z tests - Logistic regression】

输入：

![图片](https://image.cubox.pro/article/2022050120042519353/33643.jpg)

图十四：逻辑回归（预测变量为连续变量）  

注：图十四中各项参数解释如下

-   Pr(Y=1|X=1)H1：当学生对学习的喜爱程度高于平均值一个标准差（M+1SD）时其偏好理科的概率（probability）。例如，假设样本中预期的对学习的喜爱程度平均值为5、预期的标准差为1，这时Pr(Y=1|X=1)H1即为当学生对学习的喜爱程度为6（即5+1）时其偏好理科的概率。
    
-   Pr(Y=1|X=1)H0：当学生对学习的喜爱程度恰好为平均值（M）时其偏好理科的概率。仍照之前假设，样本中预期的对学习的喜爱程度平均值为5、预期的标准差为1，Pr(Y=1|X=1)H0即为当学生对学习的喜爱程度为5时其偏好理科的概率。此处设定为0.15（可参考文献设置）。
    
-   Odds ratio：Pr(Y=1|X=1)H1和Pr(Y=1|X=1)H0由probability转化为odds后取比值即为Odds ratio。计算方法为：点击Determine，输入Pr(Y=1|X=1)H1和Pr(Y=1|X=1)H0的设定值，可得预期Odds ratio。也可设定Odds ratio为中等效应量3.47。
    
    在GPower中点击Options按钮可以选择使用Odds ratio或Two probabilities其中一组效应量指标。选择Odds ratio时，输入Odds ratio及Pr(Y=1|X=1)H0的数值；选择Two probabilities时，输入Pr(Y=1|X=1)H1和Pr(Y=1|X=1)H0两个概率数值。
    
-   R2 other X：此处的R2指由协变量所解释的主要预测变量的变异的百分比。若没有协变量则输入0；若有协变量，则以预测变量为因变量，所有协变量为自变量进行一般线性回归，回归模型所报告的R2即为此处的R2 other X指标。图中设定为0.25，表明预期两个协变量（智力和学习时长）与主要预测变量（对学习的喜爱程度）有较大程度的相关。
    
-   X distribution：一般选择正态分布（normal）。
    
-   X param μ：图中设定对学习喜爱程度总体均值的z分数为0。
    
-   X param σ：图中设定对学习喜爱程度总体标准差的z分数为1。
    

输出：66人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出学生对学习喜爱程度中等大小的主效应（Odds ratio = 3.47）。

5.2. 预测变量为分类变量的逻辑回归

例：考察学生父母的文理分科偏好对学生自身文理分科偏好的预测作用，控制智力和学习时长。

主要预测变量：父母文理分科偏好（分类变量；两水平：理科=1，文科=0）；

协变量：智力（连续变量），学习时长（连续变量）；

反应变量：自身文理分科偏好（分类变量；两水平：理科=1，文科=0）。

选择逻辑回归【z tests - Logistic regression】

输入：

![图片](https://image.cubox.pro/article/2022050120042613768/94692.jpg)

图十五：逻辑回归（预测变量为分类变量）

上图中各项参数解释如下：

-   Pr(Y=1|X=1)H1：预期当父母偏好理科（X = 1）时学生自身也偏好理科（Y=1）的概率。
    
-   Pr(Y=1|X=1)H0：预期当父母偏好文科时学生自身偏好理科（Y=1）的概率。此处设定为0.15。
    
-   Odds ratio：同上一节。
    
-   R2 other X：此处的R2指由协变量所解释的主要预测变量的变异的百分比。若没有协变量则输入0；若有协变量，则以预测变量为因变量，所有协变量为自变量进行逻辑回归，回归模型所报告的R2即为此处的R2 other X指标。图中设定为0.25，表明预期两个协变量（智力和学习时长）与主要预测变量（父母文理分科偏好）有较大程度的相关。
    
-   X distribution：选择二项分布（binomial）。
    
-   X param π：父母偏好理科（X=1）者的占比为，从此处设为80%。
    

输出：271人的样本量可以在显著性水平（α）小于等于0.05和统计检验力（1-β）为0.8时检测出父母文理分科偏好中等大小的主效应（Odds ratio = 3.47）。

四、其它分析

除了GPower以外，PANGEA、jamovi、R等也可用于计算统计检验力。

-   PANGEA：https://jakewestfall.shinyapps.io/pangea/
    

![图片](https://image.cubox.pro/article/2022050120042611980/27496.jpg)

图十六：PANGEA

-   jamovi
    

在jamovi library中安装jpower后可计算统计检验力

![图片](https://image.cubox.pro/article/2022050120042613430/14580.jpg)

图十七：jmovi  

-   R
    

R语言中的webpower package提供了丰富的functions，选择合适的function后直接输入相应的参数便可计算出power、sample size等。

Webpower：https://www.rdocumentation.org/packages/WebPower/versions/0.5.2

![图片](https://image.cubox.pro/article/2022050120042591189/13911.jpg)

图十八：R语言WebPower  

附：常用效应量系数解读表

![图片](https://image.cubox.pro/article/2022050120042647778/99876.jpg)

Cohen(1988)

Chen,Cohen, & Chen (2010)

