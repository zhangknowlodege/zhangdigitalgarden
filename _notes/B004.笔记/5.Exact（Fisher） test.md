# 6 Exact
## 6.1 多元线性回归Random model
	
	线性回归是确定两种或两种以上变量间相互依赖的定量关系的一种统计分析方法，在回归分析中，如果有两个或两个以上的自变量，就称为多元回归。如果可以确定n个自变量相互独立，并与因变量组成联合多元正态分布，便可使用此方法。
	
	举例来说：有人认为，某校高中生在数学、语文、英语三门科目上所做练习题的数量可解释期末考试成绩变异的70%，但反对者认为，练习题数量所能解释的变异不超过50%。试问，要抽取多少学生参与调查，才能验证此判断？在GPower软件中我们可以如此操作：
	
	选择：
	
	Testfamily：Exact
	
	Statisticaltest: Correlation：Linear Multiple Regression：Randommodel
	
	Typeof power analysis: A priori
	
	输入：
	
	Tail(s): one
	
	H1 ρ2：0.7
	
	H2 ρ2：0.5
	
	α err prob：0.05
	
	Power (1-β) prob：0.95
	
	Number of predictors：3
	
	欲求样本数量，需要输入自变量的数量（Number of predictors），两类假设的决定系数也即多元全相关系数的平方（ρ2），需求的α与（1-β）的预设值。其中，ρ2=Σ’YXΣ-1XΣYX/σ2Y，若ρ2未知，可以点击Determine=>按钮，输入各独立自变量与因变量的相关来求出。
	
	![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic3.zhimg.com%2Fv2-7005f062e85fe830e223fb2d24021546_b.jpg)
	
	![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-54e3a7f93462fa7fd993c38b255f79d7_b.jpg)
	
	输出：
	
	Lower critical R2: 0.6182228
	
	Upper critical R2: 0.6182228
	
	Totalsample size:105
	
	Actualpower: 0.9513667
	
	从结果可知，我们研究所需的样本量至少要105个。
## 6.2 Proportion：符号检验（binomial test）
	
	符号检验法是通过两个相关样本的每对数据之差的符号进行检验，从而比较两个样本的显著性。具体地讲，若两个样本差异不显著，正差值与负差值的个数应大致各占一半。此处是针对二项分布的符号检验法。举例来说：有A、B两种治疗皮肤病的药物，有些研究员认为两种药物的效果一样好，有些研究员根据过往数据，认为A药的效果远好于B药，现在招募患有皮肤病的被试，左手涂A药，右手涂B药，效果好记为1，不好记为0。剔除相等数据后，用正负号来表示左右手的效果差异。
	
	选择：
	
	Test family：Exact
	
	Statistical test:Proportion：Sign test（binomial test）
	
	Type of power analysis: A priori
	
	输入：
	
	Tail(s): one
	
	Effect size g: 0.3
	
	α err prob: 0.05
	
	Power (1-β): 0.95
	
	其中效应量g = p−0.5 （p0 = 0.5），p为预计的正号或负号比例
	
	输出：
	
	Lower critical N：19
	
	Upper critical N：19
	
	Total sample size：28
	
	Actual power: 0.9609293
	
	Actual α：0.0435793
	
	此处输出的Total sample size: 28就表明在本例这个研究中我们的有效样本数至少要达到28个。
	
	![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-964aa7cb54ce0e59ea4e01e5174cbb1b_b.jpg)
## 6.3 Fisher's exact test （独立样本）
	
	精确检验是一族特殊的统计检验方法，它们最突出的特点是不需要统计量（t检验的t值、F检验的F值、卡方检验的卡方值）而直接利用原始数据计算出精确p值，以检验假设是否成立。
	
	Fisher's exact test和卡方检验十分相似。然而，卡方检验利用了大样本情况下数据分布渐进卡方分布的性质，得出近似的p值，并且在小样本情况下需要做若干矫正。与之相对，Fisher‘s exact test总是能够利用样本原始数据计算出精确且“有意义”的p值，但是，这种计算非常繁琐，在计算机诞生以前使用起来十分不便。计算上的不便造成了它更加适合小样本的说法，而易于计算的特点让卡方检验更为流行。
	
	下面先通过一个例子了解Fisher's exact test是如何得出精确p值的。我们对性别和节食的关系感兴趣，到路上随机采访了5名男生和5名女生，问他们是否在近期进行节食。得到的结果如下。问：女生节食的情况是否显著多于男生？虚无假设：女生节食情况和男生节食情况没有显著差异。
	
	如果虚无假设成立的话，那么我们应该观察到男生组的节食情况和女生组的节食情况差不多。假如我们观察到了一个非常极端的情况，男生组和女生组有很大的差异，那么这个时候我们就要考虑拒绝虚无假设了。所以回答这个问题的关键在于判断我们手头拿到的这个分布是不是一个极端情况，换句话说，我们看到的这个分布有多大的概率出现，这便是Fisher’s exact test中p值的含义。
	
	现在，我们把数据用字母代替，以得出计算p值的通式，如下所示。
	
	![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-fe79ed9eb4f89f194694314c3543d78f_b.jpg)
	
	两个分式的含义不同，但是计算结果相同，都等于第三个分式。对于第一个分式来说，它的含义是：从n个被试中抽取a+c个男生，恰好抽中a个男生在节食，c个男生没节食的概率；对于第二个分式来说，它的含义是：从n个被试中抽取b+d个女生，恰好抽中b个女生在节食，d个女生没节食的情况。根据组合数的性质，两者展开之后等同于第三个分式。由于需要计算阶乘，当数值变大时很难手算完成。以上便是前文所述“Fisher‘s exact test总是能够利用样本原始数据计算出精确且“有意义”的p值，但是，这种计算非常繁琐”的依据。
	
	带入数值到通式中，可得p=5!5!5!5!/1!4!4!1!10!=0.09920635。按照单尾α=0.05的标准，我们看到的分布并不算是一个极端情况，我们不能拒绝虚无假设。
	
	什么原因造成了这样的问题呢？数据分布看上去对备择假设非常有利，也就是男女生两组数据看上去是有显著差异的。这个时候我们怀疑可能是发生了第二类错误，也就是备择假设为真，但是我们却拒绝了备择假设。换句话说，统计效力太小，没有把真实的效应检验出来。
	
	现在用到Gpower软件，首先看看我们的统计效力究竟有多大，步骤如下：
	
	1）Testfamily选中Exact；
	
	2）Statisticaltest选中Fisher's exact test；
	
	3）Typeof power analysis选中Post hoc；
	
	4）Tail(s)选中One；
	
	5）Proportionp1：男生组有节食人数除以男生组总人数（1/5）；
	
	6）Proportionp2：女生组有节食人数除以女生组总人数（4/5）；
	
	7）αerr prob采用默认值0.05；
	
	8）Samplesize group 1：男生组人数（5）；
	
	9）Samplesize group 2：女生组人数（5）；
	
	10）点击Calculate，得出实际统计效力为0.38。
	
	![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-c452993514c24bfc4640f8510d73dff7_b.jpg)
	
	统计效力太小，我们可以考虑增大样本量来得到合适的结果。具体需要多大的样本量取决于研究者能够接受多大的统计效力，通常来说样本量越大，统计效力越大，但是研究成本也越大，故样本量和统计效力需要权衡。
	
	在Gpower中根据统计效力计算样本量有两种办法。其一是做出两者的关系图，在图上选择一个可接受的统计效力，查看对应的样本大小；其二是直接输入一个统计效力，并计算所需要的样本大小。
	
	方法一步骤如下：
	
	1）在之前的基础上，选择X-Y plot for a range of values；
	
	2）Plot（on y axis）选择Total sample size；
	
	3）点击Draw plot；
	
	4）可以看到统计效力0.9对应的样本大小为24，即男女组各12人。
	
	![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-d7117852573210043b99bab8ae41e19d_b.jpg)
	
	方法二步骤如下：
	
	1）在之前的基础上，Type of power analysis选中A priori；
	
	2）Power输入一个值，默认为0.95，改为0.9；
	
	3）点击Calculate，得出每组各需要12人，总共24人。
	
	![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-8da33dc09f3460fc1eb09df0735170bb_b.jpg)
## 6.4 McNemar exact test （相关样本）
	
	McNemar exact test和Fisher‘sexact test相似，但是适用于两个相关的样本。在上一个部分的例子中，我们考察了男生组和女生组在节食上的差异，男生组和女生组是两个独立的样本，所以采用Fisher’s exact test。现在我们换一个问题：同一批女生被试，观看健康宣传视频前有若干人节食，观看健康宣传视频后有若干人节食，如下表所示。问：观看健康宣传视频是否影响了女生的节食行为？这里前测组和后测组是两个相关的样本，采用McNemar exact test。
	
	回答这个问题的关键在于比较看宣传片前后行为发生反转的被试，那些看宣传片前后行为一致的被试无法反映宣传片的效果，所以只需要考虑B和C的差异即可。虚无假设为B=C，意味着原来不节食，看了宣传片后节食的人数，等同于原来节食，看了宣传片后不节食的人数，这代表宣传片的作用是随机的，既能说服女生节食，也能说服女生不节食，换句话说，它没有实质性的作用。备择假设为B<C，宣传片有实质性效果，它能说服女生不节食。
	
	现在假设我们拿到了如上的数据，想知道统计效力有多大，步骤如下：
	
	1) Testfamily选中Exact；
	
	2) Statisticaltest选中McNemar；
	
	3) Typeof power analysis选中Post hoc；
	
	4) Tail(s)选中One；
	
	5) Oddsratio = B/N / C/N = 2/20 / 8/20 = 0.25；
	
	6)αerr prob采用默认值0.05；
	
	7) Totalsample size = 20；
	
	8) Propdiscordant pairs = (B+C) / N = (2+5) / 20 = 0.5；
	
	9)点击Calculate，得出实际统计效力为0.38。
	
	![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-73a4582b7f5e845b4a7828ce9280bbb0_b.jpg)
	
	考虑增大样本量以提升统计效力。有两种办法。其一是做出两者的关系图，在图上选择一个可接受的统计效力，查看对应的样本大小；其二是直接输入一个统计效力，并计算所需要的样本大小。和Fisher‘s exact test的操作相似，不再赘述。
## 6.5 Generic binomial test
			
			这是一种通用的二项分布检验方法。举例来说：假设某公司技术部门预计新招聘员工中业绩好的人占比为0.5，人力部门认为实际占比会更高（0.8），于是技术部门在实习期结束前安排了一次业绩考核来摸底。预计要随机抽取多少新员工才能达到目的？
			
			选择：
			
			Test family：Exact
			
			Statistical test: Generic binomial test
			
			Type of power analysis: A priori
			
			输入：
			
			Tail(s): one
			
			Proportion p1：0.8
			
			Proportion p2：0.5
			
			α err prob：0.05
			
			Power (1-β) prob：0.95
			
			欲求样本数量，需要两类假设的比例（p1和p2），需求的α与（1-β）的预设值。
			
			输出：
			
			Lower critical N: 19
			
			Upper critical N: 19
			
			Total sample size: 28
			
			Actual power: 0.9609293
			
			Actual α：0.0435793
			
			从结果可知，我们研究所需的样本量至少要28个。
				![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-4cbfe90a2856b66726c81d498788dd6d_b.jpg)