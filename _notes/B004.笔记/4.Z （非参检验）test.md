# 5 Z test
- ## 5.1 Correlation - inequality of two independent Pearsonr’s
		Z检验是对比差异是否显著的假设检验方法，利用的原理是标准正态分布，重点要与T检验做区分。只有当总体方差已知且样本数大于30时才能用Z检验，在这种条件下Z检验又包括不同的几种情况，当涉及到两个独立样本的总体相关系数之间差异的假设检验时，我们就要选择Correlation：Two independent Pearson r’s。
		
		举例来说：假设我们要证明A组的学习时数与考试分数之间的相关性是否与B组的学习时数与考试分数之间的相关性存在统计学差异。已知A组的相关系数r1=0.75，B组的相关系数r2=0.88，现在已有的数据中，A组人数N1=51，B组人数N2=260，利用这些数据我们要得出A、B 两组最佳样本数，那么在GPower软件中我们的操作分为两步：
		
		第一步：
		
		选择：
		
		Test family：z test
		
		Statistical test:Correlation：Two independent Pearson r’s
		
		Type of power analysis:Post hoc
		
		输入：
		
		Tail(s): two
		
		Effect size q:-0.4028126
		
		α err prob: 0.05
		
		Sample size: 260
		
		Sample size: 51
		
		这一步的Effect size q: -0.4028126这个值，是通过Determine=>按钮，利用原始数据计算得出的，步骤为：点击Determine=>按钮，依次输入两个相关系数r1、r2，然后点击Calculate即可得到Effect size q的具体值。除此之外，α err prob，可以根据自己的实验需求填写，一般通常为0.05；样本量根据题目条件填写即可。
		
		输出：
		
		Critical z: -1.959964
		
		Power (1-β): 0.726352
		
		第二步：
		
		选择：
		
		Test family：z test
		
		Statistical test:Correlation：Two independent Pearson r’s
		
		Type of power analysis:A priori
		
		输入：
		
		Tail(s): two
		
		Effect size q:-0.4028126
		
		α err prob: 0.05
		
		Power (1-β): 0.726352
		
		Allocation ratioN2/N1:1
		
		这一步的Power (1-β): 0.726352这个值，是第一步输出的；Effect size q的值和第一步一样，Allocation ratio N2/N1是两个样本数的比例，根据自己的研究填写，我选择两个样本数相等，所以填入1。
		
		输出：
		
		Critical z: -1.959964
		
		Sample size group1:84
		
		Samole size group2:84
		
		Total sample size:168
		
		Actual power:0.7269215
		
		此处输出的Sample size group1:84和Samole sizegroup2:84就是该例子中，我们研究所需的两个组的样本量至少要每组84个，总共168个。软件操作页面如下
		
		![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-dce0398037c4bb2ac44974616d488ce5_b.jpg)
		
		![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-6074653f79690fd2ec8f328d3408e243_b.jpg)
- ## 5.2 Two dependent Pearson r`s（no common index)
	当涉及到两个相关样本的相关系数之间差异的假设检验，且两个样本不包含同一变量时，我们就要选择Correlation：Two dependent Pearson r’s （no common index）。举例来说：假设我们要证明同一样本在不同年龄阶段下对暴力性电视节目的喜爱和攻击性行为之间的相关系数是否存在统计学差异（Eron，et al．1972），具体相关系数见下图。
		![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-35a2d51c61b6357a47bcae976fc103c4_b.jpg)
	
	利用Gpower计算所需样本量时，只需将相应变量之间的相关系数填入相应选项。为方便将具体的相关系数填入Gpower中，将相关系数整理成相关矩阵的形式。
	
	选择：
	
	Test family：z test
	
	Statistical test:Correlation：Two dependent Pearson r’s（no common index)
	
	Type of power analysis:A priori:Compute required sample size-given α，power,and effect size
	
	输入：
	
	Tail（s): one
	
	H1 corr ρ_cd:0.2
	
	αerr prob:0.05
	
	Power(1-β err prob）:0.8
	
	H0 corr ρ_ab: 0.1
	
	Corr ρ_ac: 0.5
	
	Corr ρ_ad: 0.4
	
	Corr ρ_bc: -0.4
	
	Corr ρ_bd: 0.8
	
	在这一步中，“Tail（s)”若需要双侧检验，则选“two"选项；“α err prob”一般填写0.05，可根据实际情况更改；“ Power(1-β err prob）” 需大于0.8。
	
	输出：Samplesize: 886
## 5.3 Two dependent Pearson r`s（ common index)
	当涉及到两个相关样本的相关系数之间差异的假设检验，且两个样本包含同一变量时，我们就要选择Correlation：Two dependent Pearson r’s （ common index）。举例来说：假设有研究想要了解人们的生活满足感与看电视和上网之间的关系，因为电视比互联网更普及，所以假设看电视与生活满足感的相关程度高于上网与生活满意度的相关程度。其中，common index为生活满足感，具体相关指数如图：
	
	同Z-test:Two dependent Pearson r’s（no common index)一样，利用Gpower计算所需样本量时，只需将相应变量之间的相关系数填入相应选项。
	
	选择：
	
	Test family：z test
	
	Statistical test:Correlation：Two dependent Pearson r’s（ common index)
	
	Type of power analysis:A priori:Compute required sample size-given α，power,and effect size
	
	输入：
	
	Tail（s): one
	
	H1 corr ρ_ac:0.2
	
	αerr prob:0.05
	
	Power(1-β err prob）:0.8
	
	H0 corr ρ_ab: 0.4
	
	Corr ρ_bc: 0.5
	
	在这一步中，“Tail（s)”若需要双侧检验，则选“two"选项；“α err prob”一般填写0.05,可根据自己的情况更改；“ Power(1-β err prob）”需大于0.8。
	
	输出：Samplesize:144
## 5.4 Tetrachoric Correlation
			当因变量为人为二分变量时，我们就要选择Tetrachoric model，举例来说，现在有930名受访者对人格问卷中两个问题的回答是或否记录在一个2×2表格中，表格中的结果我们可以写成这样：f11=203，f12=186，f21=167，f22=374。
			
			在得到上述数据后，就可以在GPower软件中选择相关选项，以上述题目为例，我们的操作为：
			
			选择：
			
			Test family：z test
			
			Statistical test:Correlation: Tetrachoric model
			
			Type of power analysis:A priori
			
			输入：
			
			Tail(s): One
			
			H1 corrρ: 0.2399846
			
			α err prob: 0.05
			
			Power (1-β errprob):0.95
			
			H0 corrρ: 0
			
			Marginal prob x:0.6019313
			
			Marginal prob y:0.5815451
			
			这一步的H1 corrρ: 0.239984这个值，是通过Determine=>按钮，利用原始数据计算得出的，步骤为：点击Determine=>按钮，选择From C.I. calculatedfrom observed freq,依次填入f11,f12,f21,f22的值，然后点击Calculate即可得到H1 corrρ的具体值，。除此之外，α err prob，Power (1-β err prob)这两个值根据自己的实验需求填写，一般通常为0.05和0.95；H0 corrρ则为0，也就是我们的零假设，其他值无需更改。
			
			输出：
			
			Critical z: 1.644854
			
			Total sample size: 463
			
			Actual power: 0.950370
			
			H1 corrρ: 0.239985
			
			H0 corrρ: 0.0
			
			Critical r lwr:0.122484
			
			Critical r upr:0.122484
			
			Std err r: 0.074465
			
			此处输出的Total sample size: 463就表明在本例这个研究中我们的样本数至少要达到463个。软件操作页面如下：
				![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-434000d36b70ee624be0591ca01e7197_b.jpg)