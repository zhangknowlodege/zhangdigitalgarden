
- # 依然是以单个被试为例，在MATLAB中以语句的方式实现ERPs分析（部分相关代码参考彭微微老师课程~）。
- # 31MATLAB中单个被试ERPs分析
	- 3.1 根据mark类型选择数据进行叠加平均
		- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-e8e7454ac9c7a1dc4ddc77a6ba0d1db0_b.jpg)
	- 3.2 根据Mark 类型分别在条件1和条件2试次间做叠加平均并做差异波
		- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-17cb34c086c268c660a6f7fcde4b6bd3_b.jpg)
	- 3.3 选取要呈现波形图的电极点
		- 本示例中选取P4，P8，运行代码如下：
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-c26cf6cfff02c50a3d16a15ff11eaedd_b.jpg)
			- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic3.zhimg.com%2Fv2-e506fefd3f66b0b9652323edf8246742_b.jpg)
	- 【注释】
		*   Figure → 使用默认属性值创建一个新的绘图窗口，生成的图窗为当前图窗。
		*   subplot(m,n,p) →将当前图窗划分为 m×n 网格，并在第 p个位置绘图。MATLAB按行号对子图位置进行编号。第一个子图是第一行的第一列，第二个子图是第一行的第二列，依此类推。
			* ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic3.zhimg.com%2Fv2-c90f5b0b3320e83efd5bd4757314de02_b.jpg)
		*   subplot(3,1,1) → 在相应位置创建子图窗口
		*   mean\_data\_con1=squeeze(EEG\_avg\_con1(P4,:)); → 在条件1下，从叠加平均后的数据中提取P4电极的数据；
		*   mean\_data\_con2=squeeze(EEG\_avg\_con2(P4,:));→在条件2下，从叠加平均后的数据中提取P4电极的数据；
		*   plot(EEG.times,mean\_data\_con1); → 画出条件1下的平均波形图；
		*   hold on → 保持；
		*   plot(EEG.times,mean\_data\_con2);→画出条件2下的平均波形图；
		*   set(gca,'YDir','reverse'); → 设置Y轴的极性反转，即正在下，负在上；
		*   xlim(\[-200 800\]); → 定义X轴的时间窗区间；
		*   ylim(\[-15 10\]); → 定义Y轴的电压幅值scale；
		*   title('P4 average','fontsize',8); →设置绘制子图标题及标题文字字号大小；
		*   ylabel('Amplitude (uV)','fontsize',8); →定义Y轴标签名称及标签文字字号大小；
	- 3.4 峰值探测和头皮地形图绘制
		- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-d06b2111ae814c88fdafa151f9e018e3_b.jpg)
		- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic4.zhimg.com%2Fv2-b1bd8a6bf37a1d288b92c68123976cb7_b.jpg)
	- 【注释】
		*   第一行代码是在选定的时间窗内找出最小值最为该电极点的N170 peak值，第二行代码是确定这个N170 peak值的潜伏期是多少。
			*   第三行、四、五、、六行代码（红色方框）是查找特定电极的峰值和潜伏期（注意正成分用max函数，负成分用min函数），本文中选择查看电极P8在条件1和条件2下的峰值和潜伏期，在MATAB工作区间中可以看到准确的数值，如下图所是。
			    （如果要找出所有被试特定电极点的峰值和潜伏期需要对下述代码在被试间使用“for end”循环。）
			    ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic1.zhimg.com%2Fv2-4545bcdc5c5daad72fef4d3606c7d560_b.jpg)

	*   figure以下的语句实现分别绘制条件1、条件2以及条件1减去条件2下的头皮地形图。
	*   topoplot：
	* 绘制二维脑电地形图，分别画出条件1和条件2的头皮地形图。
	* 注意脑电成分的感兴趣时间窗口需要自行定义，本代码选用170~210ms的时间窗。
- 3.5 运行结果如下
	- ![](https://cubox.pro/c/filters:no_upscale()?imageUrl=https%3A%2F%2Fpic2.zhimg.com%2Fv2-6b812624d0ddbc29ccaae1bffee53d49_b.jpg)